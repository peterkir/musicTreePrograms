/*
 * WARNING
 *
 * This file is maintained automatically by Bndtools.
 * You should not edit it.
 *
 * See the BUILDING-GRADLE.md document in the root project for more details.
 *
 * Add tasks that are relevant to Java projects.
 */

assert(project != rootProject               )
assert(rootProject.hasProperty('bndCnf'    ))
assert(            hasProperty('sourceSets'))


if (!hasProperty('javaLibsDirName '        )) ext.javaLibsDirName          = '.'                 /* relative to build directory             */
if (!hasProperty('javaTestReportDirName '  )) ext.javaTestReportDirName    = 'tests/html'        /* relative to build directory / reports   */
if (!hasProperty('javaTestResultsDirName'  )) ext.javaTestResultsDirName   = 'reports/tests/xml' /* relative to build directory             */
if (!hasProperty('javaTestEnableAssertions')) ext.javaTestEnableAssertions = true
if (!hasProperty('javaTestIgnoreFailures'  )) ext.javaTestIgnoreFailures   = false
if (!hasProperty('javaTestMaxParallelForks')) ext.javaTestMaxParallelForks = 1

libsDirName           = javaLibsDirName
testResultsDirName    = javaTestResultsDirName
testReportDirName     = javaTestReportDirName
test.enableAssertions = javaTestEnableAssertions
test.ignoreFailures   = javaTestIgnoreFailures
test.maxParallelForks = javaTestMaxParallelForks

/* Setup javadoc options */
apply from: rootProject.file("${rootProject.bndCnf}/gradle/template/javaDoc.gradle")

/* Add findbugs to the project */
apply from: rootProject.file("${rootProject.bndCnf}/gradle/template/findbugs.gradle")

/* Add jacoco to the project */
apply from: rootProject.file("${rootProject.bndCnf}/gradle/template/jacoco.gradle")

distclean.doLast {
  sourceSets.each {
    if (projectDir != it.output.classesDir) {
      delete(it.output.classesDir)
    }
    if (projectDir != it.output.resourcesDir) {
      delete(it.output.resourcesDir)
    }
  }
}
